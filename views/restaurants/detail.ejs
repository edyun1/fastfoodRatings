<%- include("../partials/header") %>

<div class="panel" style="display:flex; gap:12px; align-items:center;">
  <img class="logo" src="https://img.logo.dev/<%= restaurant.domain %>?token=<%= logoToken %>" alt="<%= restaurant.chain %> logo">
  <div>
    <div class="title" style="font-size:20px;"><%= restaurant.chain %></div>
    <div class="sub"><%= restaurant.city %>, <%= restaurant.state %></div>
    <% if (restaurant.address && restaurant.address.trim().length > 0) { %>
      <div class="tiny"><%= restaurant.address %></div>
    <% } %>
  </div>
</div>

<div class="panel">
  <div class="sub">
    Average rating:
    <strong><%= avg === null ? "No ratings yet" : avg.toFixed(2) %></strong>
    <span class="tiny">(<%= count %> total)</span>
  </div>
  <div style="margin-top:10px;">
    <a class="btn" href="/restaurants/<%= restaurant._id %>/ratings/new">Rate this location</a>
  </div>
</div>

<h3>Recent ratings</h3>

<% if (ratings.length === 0) { %>
  <div class="panel">No ratings yet.</div>
<% } %>

<% ratings.forEach(rt => { %>
  <div class="panel">
    <div class="title"><%= rt.rating %>/5</div>
    <div class="tiny"><%= new Date(rt.createdAt).toLocaleString() %></div>
  </div>
<% }) %>

<%- include("../partials/footer") %>
